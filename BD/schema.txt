CREATE DATABASE MIEXPENDIO;

CREATE TABLE ROLES(
	ID_ROL INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    TIPO_ROL VARCHAR(100),
    DESCRIPCION VARCHAR(500) NOT NULL
);

CREATE TABLE USUARIOS(
    USUARIO VARCHAR(150) PRIMARY KEY NOT NULL,
    ID_ROL INT NOT NULL,
    NOMBRE_USUARIO VARCHAR(200) NOT NULL,
    DIRECCION VARCHAR(500) NOT NULL,
    EMAIL VARCHAR(200) NOT NULL,
    CELULAR CHAR(10) NOT NULL,
    PASSWORD VARCHAR(100) NOT NULL
);

CREATE TABLE PROVEEDORES(
    ID_PROVEEDOR INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    NOMBRE_PROVEEDOR VARCHAR(200) NOT NULL,
    DESCRIPCION VARCHAR(200) NOT NULL
);

CREATE TABLE PRODUCTOS(
    ID_PRODUCTO VARCHAR(50) PRIMARY KEY NOT NULL,
    NOMBRE_PRODUCTO VARCHAR(100) NOT NULL,
    DESCRIPCION VARCHAR(250),
    STOCK INT,
    PRECIO DECIMAL(9,2) NOT NULL,
    ID_PROVEEDOR INT NOT NULL
);

CREATE TABLE ORDENES(
    ID_ORDEN INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    USUARIO VARCHAR(150) NOT NULL,
    FECHA_ORDEN DATETIME NOT NULL,
    TOTAL DECIMAL(9,2) NOT NULL
);

CREATE TABLE DETALLE_ORDEN(
    ID_ORDEN INT NOT NULL,
    ID_PRODUCTO VARCHAR(50) NOT NULL,
    CANTIDAD INT NOT NULL
);

ALTER TABLE PRODUCTOS ADD CONSTRAINT PRODUCTOS_ID_PROVEEDOR_PROVEEDORES_ID_PROVEEDOR FOREIGN KEY (ID_PROVEEDOR) REFERENCES PROVEEDORES(ID_PROVEEDOR);
ALTER TABLE USUARIOS ADD CONSTRAINT USUARIOS_ID_ROL_ROLES_ID_ROL FOREIGN KEY (ID_ROL) REFERENCES ROLES(ID_ROL);
ALTER TABLE ORDENES ADD CONSTRAINT ORDENES_USUARIO_USUARIOS_USUARIO FOREIGN KEY (USUARIO) REFERENCES USUARIOS(USUARIO);
ALTER TABLE DETALLE_ORDEN ADD CONSTRAINT DETALLE_ORDEN_ID_ORDEN_ORDENES_ID_ORDEN FOREIGN KEY (ID_ORDEN) REFERENCES ORDENES(ID_ORDEN);
ALTER TABLE DETALLE_ORDEN ADD CONSTRAINT DETALLE_ORDEN_ID_PRODUCTO_PRODUCTOS_ID_PRODUCTO FOREIGN KEY (ID_PRODUCTO) REFERENCES PRODUCTOS(ID_PRODUCTO);